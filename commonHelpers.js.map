{"version":3,"file":"commonHelpers.js","sources":["../src/js/elements.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default {\n  form: document.querySelector('.js-search-form'),\n  input: document.querySelector('.js-search-input'),\n  gallery: document.querySelector('.js-gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n  loader: document.querySelector('.js-loader'),\n};\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\n// https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\nfunction base64ToBytes(base64) {\n  const binString = atob(base64);\n  return Uint8Array.from(binString, m => m.codePointAt(0));\n}\n\nconst API_KEY = new TextDecoder().decode(\n  base64ToBytes('NDQ3MzQwMDItYzM5MDBlYjc0MWM2MjEzYzdlYzI5NTNlMw==')\n);\n\nasync function searchImages({ q, page = 1, per_page } = {}) {\n  return (\n    await axios.get('/', {\n      params: {\n        key: API_KEY,\n        q: encodeURIComponent(q),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    })\n  ).data;\n}\n\nexport { searchImages };\n","function searchResultsMarkup(array) {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"152\" />\n            <ul class=\"description\">\n              <li class=\"description-items\">\n                <span class=\"accent\">Likes </span>${likes}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Views </span>${views}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Comments </span>${comments}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"accent\">Downloads </span>${downloads}\n              </li>\n            </ul>\n          </a>\n        </li>`\n    )\n    .join('');\n}\n\nfunction showElement(element) {\n  element.classList.remove('hidden');\n}\n\nfunction hideElement(element) {\n  element.classList.add('hidden');\n}\n\nexport { searchResultsMarkup, showElement, hideElement };\n","import elements from './js/elements';\nimport { searchImages } from './js/pixabay-api';\nimport {\n  searchResultsMarkup,\n  showElement,\n  hideElement,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst photosGallery = new simpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  total_pages: 0,\n};\n\nhideElement(elements.loadMoreBtn);\n\nelements.form.addEventListener('submit', searchHandler);\n\nasync function searchHandler(event) {\n  event.preventDefault();\n  elements.gallery.innerHTML = '';\n  params.page = 1;\n  params.q = elements.input.value.trim();\n  if (params.q === '') {\n    return iziToast.error({\n      message: 'Search field can not be empty!',\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  }\n  showElement(elements.loader);\n\n  try {\n    const data = await searchImages(params);\n    if (data.hits.length === 0) {\n      elements.input.value = '';\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 3000,\n        messageColor: '#fafafb',\n        backgroundColor: '#ef4040',\n        iconUrl: './error.svg',\n        progressBarColor: '#b51b1b',\n        maxWidth: '432px',\n      });\n    } else {\n      params.total_pages = Math.ceil(data.totalHits / params.per_page);\n      if (params.total_pages > 1) {\n        showElement(elements.loadMoreBtn);\n        elements.loadMoreBtn.addEventListener('click', loadMoreHandler);\n      } else {\n        hideElement(elements.loadMoreBtn);\n      }\n      elements.input.value = '';\n      elements.gallery.innerHTML = searchResultsMarkup(data.hits);\n      photosGallery.refresh();\n    }\n  } catch (err) {\n    iziToast.error({\n      message: `Something went wrong... Error: ${err}`,\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  } finally {\n    hideElement(elements.loader);\n  }\n}\n\nasync function loadMoreHandler() {\n  showElement(elements.loader);\n  params.page += 1;\n  hideElement(elements.loadMoreBtn);\n  try {\n    const data = await searchImages(params);\n    elements.gallery.insertAdjacentHTML(\n      'beforeend',\n      searchResultsMarkup(data.hits)\n    );\n    photosGallery.refresh();\n    const galleryItem = document.querySelector('.gallery-item');\n    const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (err) {\n    iziToast.error({\n      message: `Something went wrong... Error: ${err}`,\n      position: 'topCenter',\n      timeout: 3000,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      iconUrl: './error.svg',\n      progressBarColor: '#b51b1b',\n      maxWidth: '432px',\n    });\n  } finally {\n    hideElement(elements.loader);\n    if (params.page === params.total_pages) {\n      elements.loadMoreBtn.removeEventListener('click', loadMoreHandler);\n      hideElement(elements.loadMoreBtn);\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 3000,\n        maxWidth: '432px',\n      });\n    } else {\n      showElement(elements.loadMoreBtn);\n    }\n  }\n}\n"],"names":["elements","axios","base64ToBytes","base64","binString","m","API_KEY","searchImages","q","page","per_page","searchResultsMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","showElement","element","hideElement","photosGallery","simpleLightbox","params","searchHandler","event","iziToast","data","loadMoreHandler","err","galleryItemHeight"],"mappings":"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"}